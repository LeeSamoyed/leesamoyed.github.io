# Kubernetes-K8S

## K8S架构

## K8S部署(集群搭建)
- Docker基础知识
- 网络插件


## 核心使用
### 核心概念
- Namespace: 对集群资源进行隔离划分。默认只隔离资源，不隔离网络(可以用于区分两套完全一样的环境，例如区分prod和dev环境)
- Pod: Kubernetes应用的最小单位

### Deployment
- 多副本
- 扩缩容
- 自愈(能恢复)&故障转移(机器本身下线了，转移到另一个机器)
- 滚动更新
- 版本回退

### 工作负载
- Deployment: 无状态应用部署（微服务；提供多版本等功能）
- StatefulSet: 有状态应用部署服务（Redis；提供稳定的存储和网络等功能）
- DaemonSet: 守护型应用部署（日志收集组建；在每个机器都会运行一份）
- Job/CronJob: 定时任务部署（垃圾清理组建；在指定时间执行）

## Service-网络服务
本质是将一组 Pods 公开为网络服务的抽象方法

- 接口暴露
- 服务发现(当然这里需要注意，一旦重启，你在某一个Pod的修改就会消失，即虽然可以转发，但是是按着默认的Container，所以之前一旦进行了扩缩容，那么他就是真的把之前的container删除了)
- 服务暴露(主要是为了区分集群内和集群外的暴露)
  - ClusterIP
  - NodePort

## 网络模型
Ingress是Service的统一网关入口(本质其实是在套娃，不过很有效)

- Ingress层(负载均衡；反向代理；域名)
- Service层
- Pod层
- 高级配置(注解): 域名访问；域名重写；流量限制

## 存储对象
举一个例子，如果按照原本的Docker那样的挂在方式，如果Pod挂了之后，被K8S重启到另一个机器的话，那么挂载方面会有冲突？因此就诞生了一种解决方法，最终把数据的挂载交给K8S管理，形成存储层。即将存储层进行抽象

- NFS 网络文件系统(存储抽象)
- PV(Persident Volume, 持久卷, 将应用需要持久化的数据保存到指定位置)&PVC(President Volume Claim, 持久卷声明, 声明需要使用的持久卷规格)
- ConfigMap
- Secret(对象类型用来保存敏感信息, 便于统一是使用)
